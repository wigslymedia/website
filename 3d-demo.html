<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Model Viewer Demo | Dream Team Automation</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;500;600;700&family=Rajdhani:wght@500;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="assets/css/style.css">
    
    <style>
        .viewer-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .model-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .model-viewer {
            width: 100%;
            height: 350px;
            background: linear-gradient(135deg, #0a0d12 0%, #151a24 100%);
            position: relative;
            cursor: grab;
        }
        
        .model-viewer:active {
            cursor: grabbing;
        }
        
        .model-viewer canvas {
            width: 100% !important;
            height: 100% !important;
        }
        
        .model-info {
            padding: 1.5rem;
        }
        
        .model-info h3 {
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .model-info p {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }
        
        .model-controls {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        
        .model-controls button {
            padding: 0.5rem 1rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-subtle);
            color: var(--text-secondary);
            font-family: inherit;
            font-size: 0.85rem;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        
        .model-controls button:hover {
            background: var(--accent-blue);
            border-color: var(--accent-blue);
            color: var(--text-primary);
        }
        
        .loading-spinner {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--text-muted);
            font-size: 0.9rem;
        }
        
        .upload-section {
            background: var(--bg-card);
            border: 2px dashed var(--border-subtle);
            border-radius: 8px;
            padding: 3rem;
            text-align: center;
            margin-top: 2rem;
            transition: all 0.3s ease;
        }
        
        .upload-section:hover {
            border-color: var(--accent-blue);
        }
        
        .upload-section.dragover {
            border-color: var(--accent-blue);
            background: rgba(74, 158, 255, 0.1);
        }
        
        #custom-viewer {
            width: 100%;
            height: 400px;
            background: linear-gradient(135deg, #0a0d12 0%, #151a24 100%);
            border-radius: 8px;
            margin-top: 1rem;
            display: none;
        }
        
        .file-input-wrapper {
            display: inline-block;
        }
        
        .file-input-wrapper input[type="file"] {
            display: none;
        }
        
        .stats {
            display: flex;
            gap: 2rem;
            justify-content: center;
            margin-top: 1rem;
            color: var(--text-muted);
            font-size: 0.85rem;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <img src="assets/images/logo.png" alt="Dream Team Automation Logo">
                <div class="nav-logo-text">
                    <span class="nav-logo-title">Dream Team Automation</span>
                    <span class="nav-logo-subtitle">Precision Tooling Design</span>
                </div>
            </a>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="staffing.html">Staffing</a></li>
                <li><a href="services.html">Services</a></li>
                <li><a href="projects.html">Projects</a></li>
                <li><a href="careers.html">Careers</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
            <div class="nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <header class="page-header">
        <div class="container">
            <h1>3D Model Viewer</h1>
            <p>Interactive 3D printing showcase - drag to rotate, scroll to zoom</p>
        </div>
    </header>

    <!-- Demo Models Section -->
    <section class="container">
        <div class="section-header fade-in">
            <h2 class="section-title">Sample 3D Models</h2>
            <p class="section-subtitle">These are procedurally generated demo shapes. Real STL files can be loaded below.</p>
            <div class="section-divider"></div>
        </div>
        
        <div class="viewer-container">
            <!-- Demo Model 1 - Gear -->
            <div class="model-card fade-in">
                <div class="model-viewer" id="viewer1">
                    <div class="loading-spinner">Loading 3D model...</div>
                </div>
                <div class="model-info">
                    <h3>Precision Gear</h3>
                    <p>Example of a mechanical gear component - common in automation fixtures</p>
                    <div class="model-controls">
                        <button onclick="resetCamera(scene1, camera1, controls1)">Reset View</button>
                        <button onclick="toggleWireframe(mesh1)">Wireframe</button>
                        <button onclick="toggleAutoRotate(controls1)">Auto Rotate</button>
                    </div>
                </div>
            </div>
            
            <!-- Demo Model 2 - Bracket -->
            <div class="model-card fade-in">
                <div class="model-viewer" id="viewer2">
                    <div class="loading-spinner">Loading 3D model...</div>
                </div>
                <div class="model-info">
                    <h3>Mounting Bracket</h3>
                    <p>Custom bracket design for EOAT mounting applications</p>
                    <div class="model-controls">
                        <button onclick="resetCamera(scene2, camera2, controls2)">Reset View</button>
                        <button onclick="toggleWireframe(mesh2)">Wireframe</button>
                        <button onclick="toggleAutoRotate(controls2)">Auto Rotate</button>
                    </div>
                </div>
            </div>
            
            <!-- Demo Model 3 - Connector -->
            <div class="model-card fade-in">
                <div class="model-viewer" id="viewer3">
                    <div class="loading-spinner">Loading 3D model...</div>
                </div>
                <div class="model-info">
                    <h3>Pneumatic Fitting</h3>
                    <p>3D printed pneumatic connector prototype</p>
                    <div class="model-controls">
                        <button onclick="resetCamera(scene3, camera3, controls3)">Reset View</button>
                        <button onclick="toggleWireframe(mesh3)">Wireframe</button>
                        <button onclick="toggleAutoRotate(controls3)">Auto Rotate</button>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Upload Your Own Section -->
    <section class="container" style="padding-bottom: 120px;">
        <div class="section-header fade-in">
            <h2 class="section-title">Upload Your Own Model</h2>
            <p class="section-subtitle">Drag and drop an STL or OBJ file to preview it</p>
            <div class="section-divider"></div>
        </div>
        
        <div class="upload-section fade-in" id="dropZone">
            <p style="font-size: 1.2rem; color: var(--text-primary); margin-bottom: 1rem;">ðŸ“¦ Drop STL/OBJ file here</p>
            <p style="color: var(--text-muted); margin-bottom: 1.5rem;">or</p>
            <div class="file-input-wrapper">
                <label class="btn btn-primary" for="fileInput">
                    <span>Choose File</span>
                </label>
                <input type="file" id="fileInput" accept=".stl,.obj">
            </div>
            <div id="custom-viewer"></div>
            <div class="stats" id="model-stats" style="display: none;">
                <span>Vertices: <strong id="vertex-count">0</strong></span>
                <span>Faces: <strong id="face-count">0</strong></span>
                <span>File size: <strong id="file-size">0</strong></span>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <p class="footer-text">Â© 2025 Dream Team Automation, LLC</p>
                <div class="footer-badge">
                    <span class="footer-text">Clinton Twp., MI</span>
                </div>
            </div>
        </div>
    </footer>

    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/STLLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/OBJLoader.js"></script>
    
    <script>
        // Shared variables
        let scene1, camera1, renderer1, controls1, mesh1;
        let scene2, camera2, renderer2, controls2, mesh2;
        let scene3, camera3, renderer3, controls3, mesh3;
        let customScene, customCamera, customRenderer, customControls, customMesh;
        
        // Material with metallic look
        const metalMaterial = new THREE.MeshStandardMaterial({
            color: 0x8899aa,
            metalness: 0.7,
            roughness: 0.3,
            flatShading: false
        });
        
        const blueMaterial = new THREE.MeshStandardMaterial({
            color: 0x4a9eff,
            metalness: 0.5,
            roughness: 0.4,
            flatShading: false
        });
        
        // Initialize a viewer
        function initViewer(containerId, geometry, material) {
            const container = document.getElementById(containerId);
            const width = container.clientWidth;
            const height = container.clientHeight;
            
            // Scene
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0a0d12);
            
            // Camera
            const camera = new THREE.PerspectiveCamera(45, width / height, 0.1, 1000);
            camera.position.set(3, 3, 3);
            
            // Renderer
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(width, height);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.shadowMap.enabled = true;
            container.innerHTML = '';
            container.appendChild(renderer.domElement);
            
            // Lights
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(5, 10, 7);
            directionalLight.castShadow = true;
            scene.add(directionalLight);
            
            const backLight = new THREE.DirectionalLight(0x4a9eff, 0.3);
            backLight.position.set(-5, -5, -5);
            scene.add(backLight);
            
            // Grid
            const gridHelper = new THREE.GridHelper(10, 20, 0x2a3040, 0x1a2030);
            scene.add(gridHelper);
            
            // Mesh
            const mesh = new THREE.Mesh(geometry, material.clone());
            mesh.castShadow = true;
            mesh.receiveShadow = true;
            scene.add(mesh);
            
            // Center geometry
            geometry.computeBoundingBox();
            const center = new THREE.Vector3();
            geometry.boundingBox.getCenter(center);
            mesh.position.sub(center);
            
            // Controls
            const controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.autoRotate = true;
            controls.autoRotateSpeed = 1;
            
            // Animation
            function animate() {
                requestAnimationFrame(animate);
                controls.update();
                renderer.render(scene, camera);
            }
            animate();
            
            // Handle resize
            window.addEventListener('resize', () => {
                const newWidth = container.clientWidth;
                const newHeight = container.clientHeight;
                camera.aspect = newWidth / newHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(newWidth, newHeight);
            });
            
            return { scene, camera, renderer, controls, mesh };
        }
        
        // Create demo geometries
        function createGearGeometry() {
            const shape = new THREE.Shape();
            const teeth = 12;
            const innerRadius = 0.6;
            const outerRadius = 1;
            
            for (let i = 0; i < teeth; i++) {
                const angle1 = (i / teeth) * Math.PI * 2;
                const angle2 = ((i + 0.3) / teeth) * Math.PI * 2;
                const angle3 = ((i + 0.5) / teeth) * Math.PI * 2;
                const angle4 = ((i + 0.8) / teeth) * Math.PI * 2;
                
                if (i === 0) {
                    shape.moveTo(Math.cos(angle1) * innerRadius, Math.sin(angle1) * innerRadius);
                }
                shape.lineTo(Math.cos(angle2) * innerRadius, Math.sin(angle2) * innerRadius);
                shape.lineTo(Math.cos(angle2) * outerRadius, Math.sin(angle2) * outerRadius);
                shape.lineTo(Math.cos(angle3) * outerRadius, Math.sin(angle3) * outerRadius);
                shape.lineTo(Math.cos(angle4) * innerRadius, Math.sin(angle4) * innerRadius);
            }
            
            // Center hole
            const hole = new THREE.Path();
            hole.absarc(0, 0, 0.25, 0, Math.PI * 2, true);
            shape.holes.push(hole);
            
            const extrudeSettings = { depth: 0.3, bevelEnabled: true, bevelThickness: 0.05, bevelSize: 0.05 };
            return new THREE.ExtrudeGeometry(shape, extrudeSettings);
        }
        
        function createBracketGeometry() {
            const shape = new THREE.Shape();
            shape.moveTo(0, 0);
            shape.lineTo(1.5, 0);
            shape.lineTo(1.5, 0.3);
            shape.lineTo(0.3, 0.3);
            shape.lineTo(0.3, 1.2);
            shape.lineTo(0, 1.2);
            shape.lineTo(0, 0);
            
            const extrudeSettings = { depth: 0.8, bevelEnabled: true, bevelThickness: 0.03, bevelSize: 0.03 };
            const geometry = new THREE.ExtrudeGeometry(shape, extrudeSettings);
            geometry.rotateX(-Math.PI / 2);
            return geometry;
        }
        
        function createConnectorGeometry() {
            const group = new THREE.Group();
            
            // Main body
            const bodyGeom = new THREE.CylinderGeometry(0.4, 0.4, 1, 32);
            const body = new THREE.Mesh(bodyGeom, metalMaterial);
            
            // Connector end
            const connectorGeom = new THREE.CylinderGeometry(0.25, 0.3, 0.4, 32);
            const connector = new THREE.Mesh(connectorGeom, metalMaterial);
            connector.position.y = 0.7;
            
            // Flange
            const flangeGeom = new THREE.CylinderGeometry(0.55, 0.55, 0.1, 32);
            const flange = new THREE.Mesh(flangeGeom, metalMaterial);
            flange.position.y = -0.2;
            
            // Merge geometries
            const merged = new THREE.BufferGeometry();
            bodyGeom.translate(0, 0, 0);
            connectorGeom.translate(0, 0.7, 0);
            flangeGeom.translate(0, -0.2, 0);
            
            return THREE.BufferGeometryUtils ? 
                THREE.BufferGeometryUtils.mergeBufferGeometries([bodyGeom, connectorGeom, flangeGeom]) :
                bodyGeom;
        }
        
        // Initialize demo viewers
        document.addEventListener('DOMContentLoaded', () => {
            // Viewer 1 - Gear
            const gear = createGearGeometry();
            const v1 = initViewer('viewer1', gear, metalMaterial);
            scene1 = v1.scene; camera1 = v1.camera; renderer1 = v1.renderer; controls1 = v1.controls; mesh1 = v1.mesh;
            
            // Viewer 2 - Bracket
            const bracket = createBracketGeometry();
            const v2 = initViewer('viewer2', bracket, metalMaterial);
            scene2 = v2.scene; camera2 = v2.camera; renderer2 = v2.renderer; controls2 = v2.controls; mesh2 = v2.mesh;
            
            // Viewer 3 - Connector (use torus knot as placeholder)
            const connector = new THREE.TorusKnotGeometry(0.5, 0.15, 100, 16);
            const v3 = initViewer('viewer3', connector, blueMaterial);
            scene3 = v3.scene; camera3 = v3.camera; renderer3 = v3.renderer; controls3 = v3.controls; mesh3 = v3.mesh;
        });
        
        // Control functions
        function resetCamera(scene, camera, controls) {
            camera.position.set(3, 3, 3);
            controls.reset();
        }
        
        function toggleWireframe(mesh) {
            mesh.material.wireframe = !mesh.material.wireframe;
        }
        
        function toggleAutoRotate(controls) {
            controls.autoRotate = !controls.autoRotate;
        }
        
        // File upload handling
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const customViewer = document.getElementById('custom-viewer');
        const modelStats = document.getElementById('model-stats');
        
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });
        
        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('dragover');
        });
        
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file) loadFile(file);
        });
        
        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) loadFile(file);
        });
        
        function loadFile(file) {
            const extension = file.name.split('.').pop().toLowerCase();
            const reader = new FileReader();
            
            reader.onload = (e) => {
                customViewer.style.display = 'block';
                modelStats.style.display = 'flex';
                
                // Update file size
                document.getElementById('file-size').textContent = (file.size / 1024).toFixed(1) + ' KB';
                
                let geometry;
                
                if (extension === 'stl') {
                    const loader = new THREE.STLLoader();
                    geometry = loader.parse(e.target.result);
                } else if (extension === 'obj') {
                    const loader = new THREE.OBJLoader();
                    const obj = loader.parse(e.target.result);
                    geometry = obj.children[0]?.geometry || new THREE.BoxGeometry(1, 1, 1);
                }
                
                if (geometry) {
                    // Update stats
                    const vertexCount = geometry.attributes.position.count;
                    const faceCount = geometry.index ? geometry.index.count / 3 : vertexCount / 3;
                    document.getElementById('vertex-count').textContent = vertexCount.toLocaleString();
                    document.getElementById('face-count').textContent = Math.floor(faceCount).toLocaleString();
                    
                    // Create viewer
                    if (customRenderer) {
                        customRenderer.dispose();
                    }
                    
                    const result = initViewer('custom-viewer', geometry, metalMaterial);
                    customScene = result.scene;
                    customCamera = result.camera;
                    customRenderer = result.renderer;
                    customControls = result.controls;
                    customMesh = result.mesh;
                }
            };
            
            if (extension === 'stl') {
                reader.readAsArrayBuffer(file);
            } else {
                reader.readAsText(file);
            }
        }
    </script>
    
    <script src="assets/js/main.js"></script>
</body>
</html>

